<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#007bff">
    <title>POS System</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- SVG sprite: inline for compatibility -->
    <svg aria-hidden="true" style="display:none">
      <!-- icon-menu: Hamburger menu icon for navigation -->
      <symbol id="icon-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <path d="M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h18v2H3v-2z"/>
      </symbol>

      <!-- icon-basket: Shopping basket/cart icon for basket drawer -->
      <symbol id="icon-basket" viewBox="0 0 24 24">
        <title>Basket</title>
        <path d="M7 4V2c0-1.1.9-2 2-2h6c1.1 0 2 .9 2 2v2h4c.6 0 1 .4 1 1s-.4 1-1 1h-1v13c0 1.1-.9 2-2 2H6c-1.1 0-2-.9-2-2V6H3c-.6 0-1-.4-1-1s.4-1 1-1h4zm2-2v2h6V2H9zm-1 4v13h8V6H8z"/>
      </symbol>

      <!-- icon-orders: List/document icon for orders screen -->
      <symbol id="icon-orders" viewBox="0 0 24 24">
        <title>Orders</title>
        <path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z"/>
        <path d="M8 12h8v2H8v-2zm0 4h8v2H8v-2z"/>
      </symbol>

      <!-- icon-star: Star icon for favorites -->
      <symbol id="icon-star" viewBox="0 0 24 24">
        <title>Star</title>
        <path d="M12 17.3l4.2 2.5-.9-4.8 3.7-3.6-5.1-.7-2.1-4.6-2.1 4.6-5.1.7 3.7 3.6-.9 4.8 4.2-2.5z"/>
      </symbol>

      <!-- icon-edit: Pencil icon for edit actions -->
      <symbol id="icon-edit" viewBox="0 0 24 24">
        <title>Edit</title>
        <path d="M3 17.3V21h3.7L17.1 10.6l-3.7-3.7L3 17.3zm14.7-9.3L19 5.3c.4-.4.4-1 0-1.4l-2.6-2.6c-.4-.4-1-.4-1.4 0l-1.2 1.2 3.7 3.7 1.2-1.2z"/>
      </symbol>

      <!-- icon-delete: Trash/delete icon for delete actions -->
      <symbol id="icon-delete" viewBox="0 0 24 24">
        <title>Delete</title>
        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
      </symbol>

      <!-- icon-export: Download/export icon for export actions -->
      <symbol id="icon-export" viewBox="0 0 24 24">
        <title>Export</title>
        <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
      </symbol>

      <!-- icon-import: Upload/import icon for import actions -->
      <symbol id="icon-import" viewBox="0 0 24 24">
        <title>Import</title>
        <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z" transform="rotate(180 12 12)"/>
      </symbol>

      <!-- icon-settings: Gear/settings icon for settings -->
      <symbol id="icon-settings" viewBox="0 0 24 24">
        <title>Settings</title>
        <path d="M19.1 12.5c.1-.3.1-.6.1-1s0-.7-.1-1l2.1-1.6c.2-.1.2-.4.1-.6l-2-3.5c-.1-.2-.4-.3-.6-.2l-2.5 1c-.5-.4-1.1-.7-1.7-1l-.4-2.6c0-.2-.2-.4-.4-.4h-4c-.2 0-.4.2-.4.4l-.4 2.6c-.6.3-1.2.6-1.7 1l-2.5-1c-.2-.1-.5 0-.6.2l-2 3.5c-.1.2 0 .5.1.6l2.1 1.6c0 .3-.1.6-.1 1s0 .7.1 1l-2.1 1.6c-.2.1-.2.4-.1.6l2 3.5c.1.2.4.3.6.2l2.5-1c.5.4 1.1.7 1.7 1l.4 2.6c0 .2.2.4.4.4h4c.2 0 .4-.2.4-.4l.4-2.6c.6-.3 1.2-.6 1.7-1l2.5 1c.2.1.5 0 .6-.2l2-3.5c.1-.2 0-.5-.1-.6l-2.1-1.6zm-7.1 2.5c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3z"/>
      </symbol>

      <!-- icon-back: Arrow left icon for back navigation -->
      <symbol id="icon-back" viewBox="0 0 24 24">
        <title>Back</title>
        <path d="M20 11H7.8l5.6-5.6c.4-.4.4-1 0-1.4-.4-.4-1-.4-1.4 0l-7.8 7.8c-.4.4-.4 1 0 1.4l7.8 7.8c.2.2.5.3.7.3s.5-.1.7-.3c.4-.4.4-1 0-1.4L7.8 13H20c.6 0 1-.4 1-1s-.4-1-1-1z"/>
      </symbol>
    </svg>
    <div id="app">
        <!-- Take Order Screen -->
        <div id="take-order-screen" class="screen active">
            <!-- Favorites/Most Used Bar -->
            <div id="favorites-bar"></div>
            
            <!-- Category Chips -->
            <div id="category-chips"></div>
            
            <!-- Menu Grid -->
            <div id="menu-grid"></div>
        </div>
        
        <!-- Orders Screen -->
        <div id="orders-screen" class="screen">
            <div class="orders-header">
                <div class="orders-header-top">
                    <h2>Orders</h2>
                    <button class="bulk-select-toggle" id="bulk-select-toggle">Select</button>
                </div>
                <div class="orders-search-container">
                    <input type="text" id="orders-search" class="orders-search" placeholder="Search by ID or item name...">
                </div>
                <div class="bulk-actions" id="bulk-actions" style="display: none;">
                    <span class="selected-count" id="selected-count">0 selected</span>
                    <button class="bulk-action-btn" id="bulk-mark-preparing">Mark as Preparing</button>
                </div>
            </div>
            <div id="orders-list" class="orders-list">
                <!-- Orders will be rendered here -->
            </div>
        </div>
        
        <!-- Settings Screen -->
        <div id="settings-screen" class="screen">
            <div class="settings-header">
                <h2>Menu Management</h2>
            </div>
            <div class="settings-content">
                <div class="admin-section">
                    <div class="admin-header">
                        <h3>Menu Items</h3>
                        <button class="btn-primary" id="add-item-btn" aria-label="Add new menu item">
                            <svg class="icon" aria-hidden="true"><use href="#icon-edit"></use></svg>
                            <span>Add Item</span>
                        </button>
                        <button class="btn-secondary" id="restore-menu-btn" aria-label="Restore Default Menu">
                            <span>Restore Default</span>
                        </button>
                    </div>
                    <div id="admin-menu-list" class="admin-menu-list">
                        <!-- Menu items will be rendered here -->
                    </div>
                </div>
                <div class="totals-section" id="totals-section">
                    <div class="totals-header">
                        <h3>Daily Totals</h3>
                        <div class="totals-range-buttons">
                            <button class="range-btn active" data-range="today">Today</button>
                            <button class="range-btn" data-range="week">This Week</button>
                            <button class="range-btn" data-range="all">All Time</button>
                        </div>
                    </div>
                    <div id="totals-panel" class="totals-panel">
                        <!-- Totals will be rendered here -->
                    </div>
                    <div class="totals-actions">
                        <button class="btn-secondary" id="export-json-btn">Export JSON</button>
                        <button class="btn-secondary" id="export-csv-btn">Export CSV</button>
                        <button class="btn-secondary" id="import-json-btn">
                            <label for="import-file-input" style="cursor: pointer; margin: 0;">Import JSON</label>
                        </button>
                        <input type="file" id="import-file-input" accept=".json" style="display: none;">
                    </div>
                </div>
                <div class="admin-section">
                    <div class="admin-header">
                        <h3>Backup Settings</h3>
                    </div>
                    <div class="backup-settings">
                        <label class="backup-toggle-label">
                            <input type="checkbox" id="autobackup-toggle" aria-label="Enable Auto Backup">
                            <span>Enable Auto Backup</span>
                        </label>
                        <p class="backup-description">Automatically download a daily backup of your data (once per day)</p>
                    </div>
                </div>
                <div class="admin-section">
                    <div class="admin-header">
                        <h3>Performance</h3>
                    </div>
                    <div class="backup-settings">
                        <label class="backup-toggle-label">
                            <input type="checkbox" id="autoarchive-toggle" aria-label="Auto-archive old orders">
                            <span>Auto-archive orders older than 30 days</span>
                        </label>
                        <p class="backup-description">Moves orders older than 30 days into archive to keep the app fast</p>
                    </div>
                </div>
                <div class="admin-section">
                    <div class="admin-header">
                        <h3>Shop Schedule</h3>
                    </div>
                    <div class="backup-settings">
                        <label class="backup-toggle-label">
                            <input type="time" id="closing-time-input" aria-label="Daily closing time">
                            <span>Set daily closing time</span>
                        </label>
                        <div style="display:flex; gap:8px; padding: 8px 12px;">
                            <button class="btn-secondary" id="close-shop-now-btn">Close Shop Now</button>
                        </div>
                        <p class="backup-description">At closing, orders are cleared and archived so you can start fresh next day</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-item active" data-screen="take-order-screen">
                <svg class="icon" aria-hidden="true"><use href="#icon-basket"></use></svg>
                <span>Take Order</span>
            </button>
            <button class="nav-item" data-screen="orders-screen">
                <svg class="icon" aria-hidden="true"><use href="#icon-orders"></use></svg>
                <span>Orders</span>
            </button>
            <button class="nav-item" data-screen="settings-screen">
                <svg class="icon" aria-hidden="true"><use href="#icon-settings"></use></svg>
                <span>Settings</span>
            </button>
        </nav>
    </div>

    <!-- Basket Drawer -->
    <div id="basket-drawer" class="basket-drawer">
        <div class="basket-drawer-overlay"></div>
        <div class="basket-drawer-content">
            <div class="basket-drawer-header">
                <h2>Basket</h2>
                <button class="basket-drawer-close" id="basket-close-btn">×</button>
            </div>
            <div class="basket-drawer-body" id="basket-items-container">
                <!-- Basket items will be rendered here -->
            </div>
            <div class="basket-drawer-footer">
                <div class="basket-total">
                    <span class="total-label">Total:</span>
                    <span class="total-amount" id="basket-total">₹0</span>
                </div>
                <button class="create-order-btn" id="create-order-btn">Create Order</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <script src="js/menu.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/helpers.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then((registration) => {
                        console.log('SW registered:', registration);
                    })
                    .catch((error) => {
                        console.log('SW registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>

